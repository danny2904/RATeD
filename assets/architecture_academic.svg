<svg width="1000" height="600" viewBox="0 0 1000 600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
    <style>
      .text { font-family: 'Times New Roman', serif; font-size: 16px; fill: #333; }
      .title { font-family: 'Arial', sans-serif; font-weight: bold; font-size: 20px; fill: #1a202c; }
      .box { fill: #f8fafc; stroke: #333; stroke-width: 1.5; }
      .highlight { fill: #eff6ff; stroke: #2563eb; stroke-width: 2; }
      .formula { font-style: italic; font-family: 'Times New Roman', serif; font-size: 14px; }
      .shape { font-size: 12px; fill: #64748b; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="1000" height="600" fill="white" />

  <!-- Input Section -->
  <rect x="50" y="250" width="120" height="60" rx="4" class="box" />
  <text x="110" y="285" text-anchor="middle" class="text">Input Text</text>
  <text x="110" y="325" text-anchor="middle" class="shape">[Batch, Length]</text>

  <!-- Stage 1 Section -->
  <line x1="170" y1="280" x2="230" y2="280" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  
  <rect x="240" y="150" width="220" height="260" rx="8" class="highlight" />
  <text x="350" y="140" text-anchor="middle" class="title">Stage 1: RATeD Backbone</text>
  
  <rect x="260" y="230" width="180" height="100" rx="4" class="box" />
  <text x="350" y="275" text-anchor="middle" class="text">XLM-R / RoBERTa</text>
  <text x="350" y="295" text-anchor="middle" class="text">Encoder</text>
  <text x="350" y="345" text-anchor="middle" class="shape">[Batch, Seq, Hidden]</text>

  <!-- Dual Heads -->
  <path d="M440 280 L480 200" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />
  <path d="M440 280 L480 360" stroke="#333" stroke-width="2" fill="none" marker-end="url(#arrowhead)" />

  <rect x="490" y="170" width="140" height="60" rx="4" class="box" />
  <text x="560" y="205" text-anchor="middle" class="text">Classification Head</text>
  <text x="560" y="245" text-anchor="middle" class="shape">[Batch, NumLabels]</text>

  <rect x="490" y="330" width="140" height="60" rx="4" class="box" />
  <text x="560" y="365" text-anchor="middle" class="text">Rationale Head</text>
  <text x="560" y="405" text-anchor="middle" class="shape">[Batch, Seq, 2]</text>

  <!-- Loss Formula -->
  <text x="350" y="440" text-anchor="middle" class="formula">L_total = L_cls + α · L_span</text>

  <!-- Confidence Gating -->
  <line x1="630" y1="200" x2="680" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  <polygon points="690,200 750,160 810,200 750,240" class="box" stroke="#2563eb" fill="#f0f9ff" />
  <text x="750" y="205" text-anchor="middle" class="text" font-weight="bold">Gating</text>

  <!-- Paths from Gating -->
  <line x1="810" y1="200" x2="880" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="845" y="190" text-anchor="middle" class="shape">High Conf.</text>
  <rect x="890" y="170" width="100" height="60" rx="4" class="box" />
  <text x="940" y="205" text-anchor="middle" class="text">Output 1</text>

  <line x1="750" y1="240" x2="750" y2="340" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  <text x="690" y="300" text-anchor="middle" class="shape">Low Conf.</text>

  <!-- Stage 2 Section -->
  <rect x="660" y="350" width="180" height="100" rx="8" class="highlight" stroke="#7c3aed" fill="#f5f3ff" />
  <text x="750" y="340" text-anchor="middle" class="title" fill="#6d28d9">Stage 2: LLM Judge</text>
  <text x="750" y="395" text-anchor="middle" class="text">Gemini / Qwen</text>
  <text x="750" y="415" text-anchor="middle" class="text">Reasoning Head</text>

  <!-- Final Output Fusion -->
  <line x1="840" y1="400" x2="890" y2="400" x2="940" y2="400" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)" />
  <rect x="890" y="370" width="100" height="60" rx="4" class="box" />
  <text x="940" y="405" text-anchor="middle" class="text">Output 2</text>
  
  <text x="500" y="550" text-anchor="middle" class="text" font-style="italic">Figure 1: Overview of the RATeD Cascaded Framework with Multitask Learning and Confidence-based Gating.</text>
</svg>
